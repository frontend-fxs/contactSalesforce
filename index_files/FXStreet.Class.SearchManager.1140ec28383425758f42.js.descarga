(window.webpackJsonpfxsSite=window.webpackJsonpfxsSite||[]).push([[73],{400:function(e,t,n){"use strict";n.r(t);n(84),n(108),n(86);FXStreet.Class.SearchManager=function(){var e=FXStreet.Class.Base(),t=FXStreet.Util.extendObject(e);t.ContainerId="",t.SearchIconId="",t.IndexId="",t.Translations=null,t.HtmlTemplate="search",t.HtmlTemplateIndex="search-index",t.SearchInputSelector="#fxs-search-input",t.ResultsContainerId="fxs-search-results",t.IndexContainerId="index-data",t.Container=null,t.ResultsContainer=null,t.SearchInput=null,t.SearchIcon=null,t.ApiAccount=null,t.ApiKey=null;var n=null;t.init=function(e){t.setSettingsByObject(e),t.setVars(e),t.render(e)},t.setVars=function(e){""!==t.ContainerId&&(t.Container=FXStreet.Util.getjQueryObjectById(t.ContainerId,!1)),""!==t.SearchIconId&&(t.SearchIcon=FXStreet.Util.getjQueryObjectById(t.SearchIconId,!1)),n=FXStreet.Util.getObjectInstance("MenusSubscriber")};var r=null,a=null;t.GetApiManager=function(){return a||(r?$.when(r):(a=$.Deferred(),FXStreet.Util.GetAlgoliaSearch().then((function(e){var n=e(t.ApiAccount,t.ApiKey,{protocol:window.location.protocol});r=n.initIndex(t.IndexId),a.resolve(r),a=null})),a))},t.render=function(e){FXStreet.Util.loadHtmlTemplate(t.HtmlTemplate).done((function(n){var r=FXStreet.Util.renderByHtmlTemplate(n,e);t.Container.html(r),t.rendered(e)}))},t.rendered=function(e){t.SearchInput=FXStreet.Util.getjQueryObjectBySelector(t.SearchInputSelector,!1),t.addEvents()},t.addEvents=function(){null!=t.SearchInput&&t.SearchInput.on("keyup paste",t.onSearchUpdated),t.SearchIcon.on("click",(function(){t.Container.toggleClass("fxs_dBlock")}))},t.onSearchUpdated=function(e){var n=t.SearchInput.val();t.search(n)},t.search=function(e){if(""!==e){var n={hitsPerPage:50,maxValuesPerFacet:3,filters:"CultureName:"+FXStreet.Resource.CultureName};t.GetApiManager().then((function(r){r.search(e,n,t.searchDone)}))}else t.searchOff()},t.searchDone=function(e,n){FXStreet.Util.getClass("TimeZoneManager",(function(){if(null==e){var r=n.hits;t.CalculatePublicationDate(r);var a={Index:t.IndexId,Suggestions:r,Translations:t.Translations,Query:n.query};t.renderIndex(a)}else a={Index:t.IndexId,Suggestions:[],Translations:t.Translations},t.renderIndex(a),console.log(e.message);t.ResultsContainer=FXStreet.Util.getjQueryObjectById(t.ResultsContainerId,!1),null!=t.ResultsContainer&&t.ResultsContainer.show()}),(function(){}))},t.searchOff=function(){var e=FXStreet.Util.getjQueryObjectById(t.IndexContainerId,!1);null!=e&&(e.empty(),n.unsubscribe(t.ContainerId))},t.renderIndex=function(e){var r=FXStreet.Util.getjQueryObjectById(t.IndexContainerId,!1);FXStreet.Util.loadHtmlTemplate(t.HtmlTemplateIndex).done((function(a){var i=FXStreet.Util.renderByHtmlTemplate(a,e);null!=r&&(r.html(i),r.find(".fxs_it_close").click(t.searchOff),n.subscribe(t.ContainerId,l,[t.ContainerId,t.SearchIconId]))}))},t.CalculatePublicationDate=function(e){e.forEach((function(e){null!=e.PublicationTime&&(e.Publication=t.GetUserDateByUnix(e.PublicationTime))}))},t.GetUserDateByUnix=function(e){return FXStreet.Class.Patterns.Singleton.TimeZoneManager.Instance().GetUserDateByUnix(e)};var l=function(){t.searchOff()};return t}}}]);
//# sourceMappingURL=FXStreet.Class.SearchManager.1140ec28383425758f42.js.map